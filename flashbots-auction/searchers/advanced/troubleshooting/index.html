<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.6">
<link rel="search" type="application/opensearchdescription+xml" title="Flashbots Docs" href="/opensearch.xml">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous"><title data-react-helmet="true">Bundle Inclusion Troubleshooting | Flashbots Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.flashbots.net/flashbots-auction/searchers/advanced/troubleshooting"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Bundle Inclusion Troubleshooting | Flashbots Docs"><meta data-react-helmet="true" name="description" content="How to troubleshoot your Flashbots bundle not landing on-chain"><meta data-react-helmet="true" property="og:description" content="How to troubleshoot your Flashbots bundle not landing on-chain"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/troubleshooting"><link data-react-helmet="true" rel="alternate" href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/troubleshooting" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/troubleshooting" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.82ea15b4.css">
<link rel="preload" href="/assets/js/runtime~main.b6223ee1.js" as="script">
<link rel="preload" href="/assets/js/main.70fb607c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.png" alt="Flashbots Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo.png" alt="Flashbots Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"><b class="navbar__title">Flashbots Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/flashbots/docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_NKBi"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Welcome</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Flashbots Auction</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/overview">Overview</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">For Searchers</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/quick-start">Quick Start</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/faq">FAQ</a></li><li class="theme-doc-sidebar-item-category menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Advanced Concepts</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/understanding-bundles">Understanding Bundles</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/coinbase-payment">coinbase.transfer()</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/bundle-pricing">Bundle Pricing</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/rpc-endpoint">RPC Endpoint</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/reputation">Searcher Reputation</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/goerli-testnet">Goerli Testnet</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/eip1559">EIP-1559 Support</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/flashbots-auction/searchers/advanced/troubleshooting">Bundle Inclusion Troubleshooting</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/private-transaction">Private Transactions</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/searchers/advanced/bundle-cancellations">bundle cancellations</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Example Searchers</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Libraries</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" tabindex="0" href="/flashbots-auction/other-resources">Other Resources</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">MEV-Geth Releases</a></li></ul></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Flashbots Data</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Flashbots Protect</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Flashbots MEV-Boost</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Community</a></li><li class="theme-doc-sidebar-item-category menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Contribute</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://collective.flashbots.net/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Forum<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://discord.gg/flashbots" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://github.com/flashbots/pm" target="_blank" rel="noopener noreferrer" class="menu__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a href="https://status.flashbots.net/" target="_blank" rel="noopener noreferrer" class="menu__link"><span>Status<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/policies/privacy">Data Privacy Notice</a></li><li class="theme-doc-sidebar-item-link menu__list-item"><a class="menu__link" href="/policies/terms-of-service">Terms of Service</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_eoK2"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_e+kA"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Bundle Inclusion Troubleshooting</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="how-to-troubleshoot-your-flashbots-bundle-not-landing-on-chain"></a>How to troubleshoot your Flashbots bundle not landing on-chain<a class="hash-link" href="#how-to-troubleshoot-your-flashbots-bundle-not-landing-on-chain" title="Direct link to heading">#</a></h2><p>Unlike broadcasting a transaction which lands on-chain even if the transaction fails, troubleshooting Flashbots bundles is considerably more challenging, since any of the following circumstances will prevent your bundle from landing on chain:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">1. Transaction failure (ANY within the bundle)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Incentives (gas price + coinbase transfers) not high enough to offset value of block space</span></span><span class="token-line" style="color:#393A34"><span class="token plain">3. Competitors paying more for same opportunity</span></span><span class="token-line" style="color:#393A34"><span class="token plain">4. Bundle received too late to appear in target block</span></span><span class="token-line" style="color:#393A34"><span class="token plain">5. A validator for target slot not running mev-boost</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>While you might normally rely on <a href="https://etherscan.io" target="_blank" rel="noopener noreferrer">Etherscan</a> to investigate how your transaction executed, landed on-chain, and compared to competitors, that won&#x27;t work with Flashbots, a system that keeps failed transactions from hitting the chain. As a part of debugging we <em>strongly</em> recommend that you simulate your transactions, log the output, as well as keep a record of all the data you submit including your entire bundle and its signed transactions.</p><p>The above possibilities are specified in the order they should be considered, so let&#x27;s walk through each issue and demonstrate how one might discover and resolve each one. The following assumes you are using the <a href="https://github.com/flashbots/ethers-provider-flashbots-bundle" target="_blank" rel="noopener noreferrer">Flashbots Ethers Provider</a>, but the <a href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/rpc-endpoint" target="_blank" rel="noopener noreferrer">RPC calls are standard</a> and the strategies should be easy to implement in <a href="https://docs.flashbots.net/flashbots-auction/searchers/libraries/golang" target="_blank" rel="noopener noreferrer">other providers</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="does-your-transaction-work-and-pay-enough"></a>Does your transaction work and pay enough?<a class="hash-link" href="#does-your-transaction-work-and-pay-enough" title="Direct link to heading">#</a></h2><p>Covers:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">1. Transaction failure (ANY within the bundle)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">2. Incentives (gas price/coinbase transfers) not high enough to offset value of block space</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>These two issues are lumped together since their cause, investigation, and resolutions are very similar. Flashbots will not include a bundle with</p><ol><li>A reverting transaction (unless specified via <a href="/flashbots-auction/searchers/advanced/rpc-endpoint#eth_sendbundle">optional argument <code>revertingTxHashes</code></a> or uncled)</li><li><a href="https://docs.flashbots.net/flashbots-auction/searchers/advanced/eip1559#faq" target="_blank" rel="noopener noreferrer">Gas price below base fee</a> (would create an invalid block if included)</li><li>Effective priority fee not high enough to offset opportunity cost of using that block space for other unrelated transactions <em>(e.g. your bundle is paying 1 Gwei priority fee, while the cheapest transaction in the block is paying 2 Gwei, it is in the builder&#x27;s best interest to discard your bundle in favor of standard pending transactions)</em></li></ol><p>As any of these conditions result in your bundle not appearing in a block, troubleshooting these issues requires <em>simulation</em> using <code>eth_callBundle</code> RPC call. <code>eth_callBundle</code> is similar to an <code>eth_call</code> you might already be familiar with, but offers these key benefits:</p><ol><li>Operates on an array of <em>signed</em> transactions, instead of a single [unsigned] transaction description. These transactions are executed in sequence starting at the top of the specified block. Simulating with signed transactions leaves very little difference between how your system creates transactions and how they will be processed on-chain (e.g. you can never use an incorrect <code>from</code> field when simulating a signed transaction)</li><li>Returns gas used and coinbase transfer, per transaction. (Coinbase transfer factors into effective gas price)</li><li>Allows specifying the exact values for the following arguments, allowing more accurate simulation:<ul><li>State block number (what values are read from SLOADs)</li><li>EVM block number (what value is returned from <code>block.number</code>)</li><li>EVM timestamp (what value is returned from <code>block.timestamp</code>)</li></ul></li></ol><p>The Flashbots ethers.js provider exposes <code>eth_callBundle</code> via the <a href="https://github.com/flashbots/ethers-provider-flashbots-bundle#simulate-and-send" target="_blank" rel="noopener noreferrer">simulate() method</a>. This only operates on a pre-signed bundle, so you must sign your bundle transactions manually.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">  const signedTransactions = await flashbotsProvider.signBundle(transactionBundle)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  const simulation = await flashbotsProvider.simulate(signedTransactions, targetBlockNumber, targetBlockNumber + 1)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  console.log(JSON.stringify(simulation, null, 2))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Output:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;totalGasUsed&quot;: 98564,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;bundleHash&quot;: &quot;0x9a6a9fa038343fe3c57260fb7bdb2c79ebadb3088656300d8a494123ebda6d85&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;coinbaseDiff&quot;: BigNumber(0x034dc9949767a4),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;results&quot;: [</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;coinbaseDiff&quot;: &quot;929953106847652&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;ethSentToCoinbase&quot;: &quot;0&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;fromAddress&quot;: &quot;0x9874Ef8519a0Fc7a6B553aad92fDF0E469488931&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;gasFees&quot;: &quot;929953106847652&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;gasPrice&quot;: &quot;35008022393&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;gasUsed&quot;: 29964,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;toAddress&quot;: &quot;0x48B2dD9CEFbA73c60882478a16BC3428Aceed2B9&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;txHash&quot;: &quot;0xee3f6f22bf3b4740b36833d41d4872f48f98c6328fa04b3679558e482ba0e328&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;value&quot;: &quot;0x0000000000000000000000000000000000000000000000000000000000000001&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ],</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To resolve, ensure the response from <code>eth_callBundle</code> does not revert and matches your expectations for bundle profitability. Compare your bundle&#x27;s effective gas price against the profit of the conflicting bundle.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="is-your-bundle-paying-enough-to-be-competitive"></a>Is your bundle paying enough to be competitive?<a class="hash-link" href="#is-your-bundle-paying-enough-to-be-competitive" title="Direct link to heading">#</a></h2><p>Covers:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">3. Competitors paying more</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><a href="https://docs.flashbots.net/flashbots-auction/overview" target="_blank" rel="noopener noreferrer">Flashbots bundles adhere to a &quot;blind&quot; auction</a>, where bundle pricing is not released by Flashbots prior to landing on-chain. The winning &quot;bids&quot; are revealed <em>only</em> after the block containing winning bundles is propagated (via the transactions themselves and blocks-api for recognizing which set of transactions belong to a bundle).</p><p>While you cannot see a competitor&#x27;s bid in real time, it is possible to look AFTER the fact to:</p><ol><li>Identify the exact bundle (if any) that conflicted with yours</li><li>Compare the conflicting bundle&#x27;s <code>effective priority fee</code> with your own (to see if you should be bidding more to remain competitive)</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="types-of-conflicts"></a>Types of conflicts<a class="hash-link" href="#types-of-conflicts" title="Direct link to heading">#</a></h3><p>There are numerous reasons why two bundles might conflict. Consider that the basic algorithm for merging bundles is:</p><ol><li>Simulate each bundle at the top of the block</li><li>Sort bundles by <code>effective priority fee</code>, highest first</li><li>In descending order, try each bundle <strong>that does not error or lower its effective priority fee from top-of-block simulation</strong> until you reach a maximum bundle inclusion count or you run out of profitable bundles</li></ol><p>A conflict occurs when a bundle simulates one way at the top of the block, and a different [worse] way when placed after another bundle. Here is a list of the ways a bundle could conflict:</p><ol><li><strong>Nonce collision</strong> - The target bundle includes a transaction from account <code>A</code> and nonce <code>B</code>. The conflicting bundle also includes a transaction from account <code>A</code> and nonce <code>B</code>. The most common case for nonce collision is from including the exact same transaction, but it doesn&#x27;t have to be; the conflicting bundle only needs to increment an account&#x27;s nonce via any transaction.</li><li><strong>Revert</strong> - The target bundle has no reverting transactions when simulated at the top of the block, but reverts when placed after a conflicting bundle that appears first</li><li><strong>Effective Priority Fee</strong> - A bundle cannot significantly reduce its priority fee between simulating at the top of the block and when it is selected for inclusion. This commonly occurs when a bundle is operating on an arbitrage for which it pays a % of the profit to the validator, with an earlier bundle taking part, but not all, of the arbitrage opportunity.</li></ol><h3><a aria-hidden="true" tabindex="-1" class="anchor anchor__h3 anchorWithStickyNavbar_y2LR" id="detecting"></a>Detecting<a class="hash-link" href="#detecting" title="Direct link to heading">#</a></h3><p>If a block you targeted contained Flashbots bundles, but yours did not appear, the next step is to determine which bundles conflicted with yours and, if present, calculate their <code>effective priority fee</code>. This can be accomplished through several iterations of simulations, using this strategy:</p><ol><li>Simulate your bundle at the head of the target block, note its revert states and <code>effective priority fee</code></li><li>Fetch all bundles found in the target block</li><li>Simulate [bundle1 + your bundle] as a single bundle, check the behavior of your bundle</li><li>Simulate [bundle1 + bundle2 + your bundle] as a single bundle, see the behavior of your bundle</li><li>Simulate [bundle1 + bundle2 + ...bundleN + your bundle] as a single bundle, see the behavior of your bundle</li><li>And so on...</li></ol><p>Using this method, we can identify the conflicting bundle that caused your target bundle to change behavior. The <code>Flashbots ethers.js provider</code> has a built-in helper function for running this strategy called <code>getConflictingBundle()</code>:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">const signedTransactions = await flashbotsProvider.signBundle(transactionBundle)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">console.log(await flashbotsProvider.getConflictingBundle(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      signedTransactions,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      13140328 // blockNumber</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ))</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Output:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;conflictType&quot;: FlashbotsBundleConflictType.NonceCollision,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;initialSimulation&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;totalGasUsed&quot;: 205860,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;bundleHash&quot;: &quot;0x1720ea33d96dca026dddd5689f8cad21966988348ced04e9054a0dca5d60f1d4&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;coinbaseDiff&quot;: BigNumber(0x0176750858d000),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;results&quot;: [...]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;targetBundleGasPricing&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;gasUsed&quot;: 205860,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;txCount&quot;: 1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;gasFeesPaidBySearcher&quot;: BigNumber(0x0176750858d000),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;priorityFeesReceivedByMiner&quot;: BigNumber(0x52efd8d80dbc24),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ethSentToCoinbase&quot;: BigNumber.from(0x00),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;effectiveGasPriceToSearcher&quot;: BigNumber(0x77359400),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;effectivePriorityFeeToMiner&quot;: BigNumber(0x1a6734f601)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;conflictingBundleGasPricing&quot;: {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;gasUsed&quot;: 396462,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;txCount&quot;: 3,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;gasFeesPaidBySearcher&quot;: BigNumber(0xc4c3c97ce1bff8b4),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;priorityFeesReceivedByMiner&quot;: BigNumber(0xc4213e4d7ad82006),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;ethSentToCoinbase&quot;: BigNumber(0xc4c2663d3b804731),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;effectiveGasPriceToSearcher&quot;: BigNumber(0x410ce509aa1e),</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;effectivePriorityFeeToMiner&quot;: BigNumber(0x40f2069f201d)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;conflictingBundle&quot;: [</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;transaction_hash&quot;: &quot;0x23a33038289dda1b6e722835d2b9388cb41d96d085c19ca6b71bb3e9697e6692&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;tx_index&quot;: 0,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;bundle_type&quot;: &quot;flashbots&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;bundle_index&quot;: 0,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;block_number&quot;: 13140328,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;eoa_address&quot;: &quot;0x38563699560e4512c7574C8cC5Cf89fd43923BcA&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;to_address&quot;: &quot;0x000000000035B5e5ad9019092C665357240f594e&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;gas_used&quot;: 100893,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;gas_price&quot;: &quot;0&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;coinbase_transfer&quot;: &quot;0&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      &quot;total_miner_reward&quot;: &quot;0&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span></span><span class="token-line" style="color:#393A34"><span class="token plain">   ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Parameters with <code>miner</code> in the name are retrofitted with Flashbots block builder data to maintain backwards compatibility. This nomenclature will be changed in a future release to accurately reflect PoS Ethereum architecture.</p></div></div><p>To resolve, first determine if you have an issue of competitors paying more and, if so, increase your <code>effective priority fee</code>. This can be accomplished either by paying more to the builder or validator, <em>or</em> using less gas to accomplish the same opportunity.</p><p>If your bundles are not outbid by a conflicting bundle, check to see if your bundles are being received too late:</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="is-your-bundle-received-too-late"></a>Is your bundle received too late?<a class="hash-link" href="#is-your-bundle-received-too-late" title="Direct link to heading">#</a></h2><p>Covers:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">4. Bundle received too late to appear in target block</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Each bundle submission targets only a specific block number, so it is important that the bundle is received as early as possible to ensure the bundle has time to:</p><ol><li>Reach the builder</li><li>Pass simulation</li><li>Get included in a block</li><li>Reach the validator via an mev-boost relay</li></ol><p>All this must occur prior to the targeted block being proposed. If you are targeting <code>blockNumber +1</code>, as most bundles do, it is important to get your bundle to your builder(s) as fast as possible.</p><p>Keep in mind there is a period of time, for every block, when your local perspective of block height is <code>X</code>, while <code>X+1</code> has already been found and propagated to part of the network, without reaching your local node yet. During this period of partial propagation, submitting a bundle targeting <code>X+1</code>, while seemingly valid from your perspective of the network, can be futile as builders may have already begun work on solving X+2. This is the most extreme case, but the same logic also holds true of targeting <code>X+1</code> moments BEFORE it is found as steps 1 through 5 all take time (on the order of about 1-2 seconds).</p><p>To see how much time elapsed between your bundle being submitted to Flashbots, forwarded to relays (previously bundles were sent directly to miners), and the next block being proposed, Flashbots offers an RPC endpoint <code>eth_getBundleStats</code> which will return timing to you, based on a previously-submitted bundle. All submitted bundles have a bundleHash <a href="https://github.com/flashbots/ethers-provider-flashbots-bundle/blob/0d404bb041b82c12789bd62b18e218304a095b6f/src/index.ts#L266-L269" target="_blank" rel="noopener noreferrer">which is easy to calculate</a> and target block number which uniquely identify them for later retrieval.</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">console.log(</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  await flashbotsProvider.getBundleStats(&quot;0x123456789abcdef123456789abcdef123456789abcdef123456789abcdef1234&quot;, 13509887)</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  )</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Output:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">{</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;isSimulated&quot;: true,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;isSentToMiners&quot;: true,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;isHighPriority&quot;: true,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;simulatedAt&quot;: &quot;2021-10-29T04:00:50.526Z&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;submittedAt&quot;: &quot;2021-10-29T04:00:50.472Z&quot;,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  &quot;sentToMinersAt&quot;: &quot;2021-10-29T04:00:50.546Z&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p>Parameters with <code>miner</code> in the name are retrofitted with Flashbots block builder data to maintain backwards compatibility. This nomenclature will be changed in a future release to accurately reflect PoS Ethereum architecture.</p></div></div><p>Compare the above times to the times you witness the targeted block propagated to your node.</p><ul><li>If the amount of time is short, get your processing time and network latency down.</li><li>If the amount of time between <code>sentToMinersAt</code> and witnessing the target block is large, continue to the next section</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="is-the-validator-for-a-particular-blockslot-running-mev-boost"></a>Is the validator for a particular block/slot running mev-boost?<a class="hash-link" href="#is-the-validator-for-a-particular-blockslot-running-mev-boost" title="Direct link to heading">#</a></h2><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">5. A validator for target slot not running mev-boost</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>mev-boost is an opt-in system that runs alongside a validator&#x27;s consensus client. Unless every validator on Ethereum runs mev-boost, some slots cannot be targeted with Flashbots. Additionally, your builder must be connected to the same relay as the proposer for the target slot.</p><p>If no bundles are detected in the blocks-api response, check if other blocks from the same validator ever have Flashbots bundles. If no blocks from a particular validator contain Flashbots bundles, it is possible your bundle was not seen by the validator who proposed the block for the target block height.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="new-blocks-api-fields"></a>New Blocks API fields<a class="hash-link" href="#new-blocks-api-fields" title="Direct link to heading">#</a></h2><p>New fields have been added to the blocks API to align the API with PoS Ethereum nomenclature. Details can be found in the <a href="/flashbots-data/blockapi">Blocks API page</a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor anchor__h2 anchorWithStickyNavbar_y2LR" id="everything-checks-out-whats-next"></a>Everything checks out, what&#x27;s next?<a class="hash-link" href="#everything-checks-out-whats-next" title="Direct link to heading">#</a></h2><p>Once you have validated the above issues are not affecting your bundle submission, consider filling out the Flashbots searcher support form:</p><p><a href="https://www.notion.so/flashbots/Searcher-Issue-Reporting-Form-700a5ff3843a443c993912099b4c1b56" target="_blank" rel="noopener noreferrer">Fill out our Searcher Issue Reporting Form</a></p><p>Be sure to include the output from the above RPC calls:</p><ul><li>eth_callBundle / simulate</li><li>eth_getBundleStats</li><li>getConflictingBundle</li></ul><p>in the form submission.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/flashbots-auction/searchers/advanced/eip1559"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« EIP-1559 Support</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/flashbots-auction/searchers/advanced/private-transaction"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Private Transactions Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#how-to-troubleshoot-your-flashbots-bundle-not-landing-on-chain" class="table-of-contents__link">How to troubleshoot your Flashbots bundle not landing on-chain</a></li><li><a href="#does-your-transaction-work-and-pay-enough" class="table-of-contents__link">Does your transaction work and pay enough?</a></li><li><a href="#is-your-bundle-paying-enough-to-be-competitive" class="table-of-contents__link">Is your bundle paying enough to be competitive?</a><ul><li><a href="#types-of-conflicts" class="table-of-contents__link">Types of conflicts</a></li><li><a href="#detecting" class="table-of-contents__link">Detecting</a></li></ul></li><li><a href="#is-your-bundle-received-too-late" class="table-of-contents__link">Is your bundle received too late?</a></li><li><a href="#is-the-validator-for-a-particular-blockslot-running-mev-boost" class="table-of-contents__link">Is the validator for a particular block/slot running mev-boost?</a></li><li><a href="#new-blocks-api-fields" class="table-of-contents__link">New Blocks API fields</a></li><li><a href="#everything-checks-out-whats-next" class="table-of-contents__link">Everything checks out, what&#39;s next?</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.b6223ee1.js"></script>
<script src="/assets/js/main.70fb607c.js"></script>
</body>
</html>