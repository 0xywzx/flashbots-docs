"use strict";(self.webpackChunkflashbot_docs=self.webpackChunkflashbot_docs||[]).push([[3399],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>b});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),c=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(s.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},p=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(n),b=r,h=p["".concat(s,".").concat(b)]||p[b]||d[b]||i;return n?a.createElement(h,o(o({ref:t},u),{},{components:n})):a.createElement(h,o({ref:t},u))}));function b(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var c=2;c<i;c++)o[c]=n[c];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}p.displayName="MDXCreateElement"},5567:(e,t,n)=>{n.r(t),n.d(t,{frontMatter:()=>i,contentTitle:()=>o,metadata:()=>l,toc:()=>s,default:()=>u});var a=n(7462),r=(n(7294),n(3905));const i={title:"bundle pricing"},o=void 0,l={unversionedId:"flashbots-auction/searchers/advanced/bundle-pricing",id:"flashbots-auction/searchers/advanced/bundle-pricing",isDocsHomePage:!1,title:"bundle pricing",description:"Understanding bundle pricing",source:"@site/docs/flashbots-auction/searchers/advanced/bundle-pricing.md",sourceDirName:"flashbots-auction/searchers/advanced",slug:"/flashbots-auction/searchers/advanced/bundle-pricing",permalink:"/flashbots-auction/searchers/advanced/bundle-pricing",tags:[],version:"current",frontMatter:{title:"bundle pricing"},sidebar:"docs",previous:{title:"coinbase.transfer()",permalink:"/flashbots-auction/searchers/advanced/coinbase-payment"},next:{title:"RPC endpoint",permalink:"/flashbots-auction/searchers/advanced/rpc-endpoint"}},s=[{value:"Understanding bundle pricing",id:"understanding-bundle-pricing",children:[]},{value:"Bundle ordering formula",id:"bundle-ordering-formula",children:[]},{value:"Why aren&#39;t my bundles being included?",id:"why-arent-my-bundles-being-included",children:[]}],c={toc:s};function u({components:e,...t}){return(0,r.kt)("wrapper",(0,a.Z)({},c,t,{components:e,mdxType:"MDXLayout"}),(0,r.kt)("h3",{id:"understanding-bundle-pricing"},"Understanding bundle pricing"),(0,r.kt)("p",null,"Searchers submit a huge amount of bundles every block, but the amount of blockspace is limited. So what decides what can be included in a block or not? To understand the answer we will first review some context."),(0,r.kt)("p",null,"At a high level ",(0,r.kt)("em",{parentName:"p"},"the Flashbots block builder is designed to include the most profitable transactions possible in the blocks it builds"),"."),(0,r.kt)("p",null,"In ",(0,r.kt)("strong",{parentName:"p"},"PoW Ethereum"),", this was achieved by inserting searcher's bundles at the ",(0,r.kt)("em",{parentName:"p"},"top of block")," and removing transactions at the ",(0,r.kt)("em",{parentName:"p"},"tail of the block"),". Measured by gas price, these transactions at the tail of a block were the ",(0,r.kt)("em",{parentName:"p"},"least profitable")," for a miner to mine. That meant that for a Flashbots bundle to be considered profitable it must have a higher effective gas price than the transactions it displaces at the tail of the block."),(0,r.kt)("p",null,"In ",(0,r.kt)("strong",{parentName:"p"},"PoS Ethereum"),", the rule of thumb for bundle pricing on Flashbots is practically the same; more profitable transactions will generally be favored by the block-building algorithm. Bundle/transaction profitability is determined by fee per gas used, priority fee, and direct validator payments."),(0,r.kt)("p",null,"The most notable difference in PoS is that instead of all bundles being placed at the top of the block, bundles may be placed anywhere in a block. This might mean that other transactions (e.g. from the mempool) are placed between bundles. Bundles are still atomic, though -- no transactions will be placed in-between bundle transactions, only in-between separate bundles."),(0,r.kt)("h3",{id:"bundle-ordering-formula"},"Bundle ordering formula"),(0,r.kt)("p",null,"The Flashbots builder uses a new algorithm designed to produce the most profitable block possible. This design introduces some important changes for searchers to be aware of:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Instead of ranking and including bundles based off of effective gas price the algorithm now optimizes for overall block profit."),(0,r.kt)("li",{parentName:"ul"},"Top-of-block execution is no longer a guarantee."),(0,r.kt)("li",{parentName:"ul"},"Bundle ordering by effective gas price is no longer a guarantee."),(0,r.kt)("li",{parentName:"ul"},"Other transactions (e.g. from the mempool) may land between bundles (not between transactions in bundles, but between two different bundles).",(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"For example:"),(0,r.kt)("li",{parentName:"ul"},"If you have a bundle comprised of transactions ",(0,r.kt)("inlineCode",{parentName:"li"},"[B1, B2]")),(0,r.kt)("li",{parentName:"ul"},"and someone else has a bundle comprised of transactions ",(0,r.kt)("inlineCode",{parentName:"li"},"[C1, C2]")),(0,r.kt)("li",{parentName:"ul"},"and there are transactions in the mempool ",(0,r.kt)("inlineCode",{parentName:"li"},"[t1, t2, ...]"),","),(0,r.kt)("li",{parentName:"ul"},"then the block may be built such that:"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"BLOCK_TXS = [..., B1, B2, t1, t2, C1, C2, ...]"),".")))),(0,r.kt)("h3",{id:"why-arent-my-bundles-being-included"},"Why aren't my bundles being included?"),(0,r.kt)("p",null,"There are three reasons to examine. First, your bundles may not be paying a higher gas price than the tail end of a block. You should examine the gas price that your bundles are paying by first simulating the bundles and looking at the coinbase difference and gas consumed. If it is lower than the tail end of recent blocks you will need to up your gas price accordingly."),(0,r.kt)("p",null,"Second, you may be competing with other searchers to capture the same opportunities, and they may be paying a higher gas price than you. Again, check the gas price that your bundles are paying by simulating them first and logging how much you are paying for a particular opportunity in a particular block. Then if your bundle is not included you can use the ",(0,r.kt)("a",{parentName:"p",href:"https://blocks.flashbots.net/"},"blocks API")," to see what bundle was included in your target block and how much they paid."),(0,r.kt)("p",null,"Third, bundles below 42,000 gas used are rejected by the Flashbots builder. This is to mitigate spam bundles that do nothing meaningful on chain."))}u.isMDXComponent=!0}}]);